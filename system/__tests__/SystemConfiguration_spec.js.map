{"version":3,"sources":["../../../src/system/__tests__/SystemConfiguration_spec.js"],"names":["jest","mock","describe","configuration","mockApi","mockConfiguration","systemId","feedbackRecipients","name","created","lastUpdated","externalAccess","user","id","offlineOrganisationUnitLevel","infrastructuralIndicators","publicAccess","infrastructuralDataElements","infrastructuralPeriodType","selfRegistrationRole","selfRegistrationOrgUnit","code","corsWhitelist","remoteServerUrl","remoteServerUsername","mockCorsWhitelistText","beforeEach","MockApi","getApi","mockClear","SystemConfiguration","it","expect","toThrowErrorMatchingSnapshot","api","toBe","all","toBeInstanceOf","Function","get","apiMockObject","mockImplementation","url","Promise","resolve","reject","post","mockReturnValue","delete","afterEach","assertions","then","res","toEqual","toHaveBeenCalledTimes","calls","res1","res2","catch","err","toMatchSnapshot","set","mockReset","message"],"mappings":"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","sourcesContent":["import MockApi from '../../api/Api';\nimport SystemConfiguration from '../SystemConfiguration';\n\njest.mock('../../api/Api');\n\ndescribe('System.configuration', () => {\n    let configuration;\n    let mockApi;\n\n    const mockConfiguration = {\n        systemId: 'eed3d451-4ff5-4193-b951-ffcc68954299',\n        feedbackRecipients: {\n            name: 'Feedback Message Recipients',\n            created: '2011-12-25T16:52:04.409+0000',\n            lastUpdated: '2015-10-19T10:27:27.636+0000',\n            externalAccess: false,\n            user: {\n                name: 'John Traore',\n                created: '2013-04-18T17:15:08.407+0000',\n                lastUpdated: '2015-09-14T20:18:28.355+0000',\n                externalAccess: false,\n                id: 'xE7jOejl9FI',\n            },\n            id: 'QYrzIjSfI8z',\n        },\n        offlineOrganisationUnitLevel: {\n            name: 'Chiefdom',\n            created: '2011-12-24T12:24:22.935+0000',\n            lastUpdated: '2015-08-09T12:58:05.001+0000',\n            externalAccess: false,\n            id: 'tTUf91fCytl',\n        },\n        infrastructuralIndicators: {\n            name: 'Staffing',\n            created: '2013-04-18T14:36:27.000+0000',\n            lastUpdated: '2013-04-18T14:36:27.000+0000',\n            externalAccess: false,\n            publicAccess: 'rw------',\n            id: 'EdDc97EJUdd',\n        },\n        infrastructuralDataElements: {\n            name: 'Population Estimates',\n            created: '2011-12-24T12:24:24.298+0000',\n            lastUpdated: '2013-03-15T16:08:56.135+0000',\n            externalAccess: false,\n            publicAccess: 'rw------',\n            id: 'sP7jTt3YGBb',\n        },\n        infrastructuralPeriodType: 'Yearly',\n        selfRegistrationRole: {\n            name: 'Guest',\n            created: '2012-11-13T15:56:23.510+0000',\n            lastUpdated: '2015-01-20T11:32:40.188+0000',\n            externalAccess: false,\n            id: 'XS0dNzuZmfH',\n        },\n        selfRegistrationOrgUnit: {\n            code: 'OU_525',\n            name: 'Sierra Leone',\n            created: '2012-11-13T12:20:53.028+0000',\n            lastUpdated: '2015-04-24T11:21:00.090+0000',\n            externalAccess: false,\n            user: {\n                name: 'Tom Wakiki',\n                created: '2012-11-21T12:02:04.303+0000',\n                lastUpdated: '2015-10-19T10:27:27.567+0000',\n                externalAccess: false,\n                id: 'GOLswS44mh8',\n            },\n            id: 'ImspTQPwCqd',\n        },\n        corsWhitelist: [\n            'http://cors1.example.com',\n            'https://cors2.example.com',\n        ],\n        remoteServerUrl: 'https://apps.dhis2.org/demo',\n        remoteServerUsername: 'admin',\n    };\n\n    const mockCorsWhitelistText = 'http://cors1.example.com\\nhttps://cors2.example.com';\n\n    beforeEach(() => {\n        mockApi = MockApi.getApi();\n        MockApi.mockClear();\n        configuration = new SystemConfiguration();\n    });\n\n    it('should not be allowed to be called without new', () => {\n        expect(() => SystemConfiguration()).toThrowErrorMatchingSnapshot();\n    });\n\n    it('should add the mockApi onto the SystemConfiguration instance', () => {\n        expect(configuration.api).toBe(mockApi);\n    });\n\n    it('all() should be a function', () => {\n        expect(configuration.all).toBeInstanceOf(Function);\n    });\n\n    it('get() should be a function', () => {\n        expect(configuration.get).toBeInstanceOf(Function);\n    });\n\n    it('should use the api object when it is passed', () => {\n        const apiMockObject = {};\n\n        configuration = new SystemConfiguration(apiMockObject);\n\n        expect(configuration.api).toBe(apiMockObject);\n    });\n\n    describe('API call', () => {\n        beforeEach(() => {\n            mockApi.get.mockImplementation((url) => {\n                if (url === 'configuration') {\n                    return Promise.resolve(mockConfiguration);\n                }\n                return Promise.reject();\n            });\n            mockApi.post.mockReturnValue(Promise.resolve());\n            mockApi.delete.mockReturnValue(Promise.resolve());\n        });\n\n        afterEach(() => {\n            configuration = new SystemConfiguration();\n        });\n\n        describe('.all()', () => {\n            it('should return the entire config', () => {\n                expect.assertions(1);\n\n                return configuration.all().then((res) => {\n                    expect(res).toEqual(mockConfiguration);\n                });\n            });\n\n            it('should query the API for all configuration endpoints', () => {\n                configuration.all();\n\n                expect(mockApi.get).toHaveBeenCalledTimes(1);\n                expect(mockApi.get.mock.calls[0][0]).toBe('configuration');\n            });\n\n            it('should only call the API once', () => {\n                expect.assertions(4);\n\n                return configuration.all().then(() => {\n                    configuration.all().then(() => {\n                        expect(mockApi.get).toHaveBeenCalledTimes(1);\n                        expect(mockApi.get.mock.calls[0][0]).toBe('configuration');\n                    });\n                    expect(mockApi.get).toHaveBeenCalledTimes(1);\n                    expect(mockApi.get.mock.calls[0][0]).toBe('configuration');\n                });\n            });\n\n            it('should call the API again if ignoreCache is true', () => {\n                expect.assertions(5);\n\n                return configuration.all(true).then(() => {\n                    expect(mockApi.get).toHaveBeenCalledTimes(1);\n                    expect(mockApi.get.mock.calls[0][0]).toBe('configuration');\n\n                    return configuration.all(true).then(() => {\n                        expect(mockApi.get).toHaveBeenCalledTimes(2);\n                        expect(mockApi.get.mock.calls[0][0]).toBe('configuration');\n                        expect(mockApi.get.mock.calls[1][0]).toBe('configuration');\n                    });\n                });\n            });\n        });\n\n        describe('.get()', () => {\n            it('should return the correct systemId', () => {\n                expect.assertions(1);\n\n                return configuration.get('systemId').then((res) => {\n                    expect(res).toBe(mockConfiguration.systemId);\n                });\n            });\n\n            it('should return the correct feedback recipient user group', () => {\n                expect.assertions(1);\n\n                return configuration.get('feedbackRecipients').then((res) => {\n                    expect(res).toBe(mockConfiguration.feedbackRecipients);\n                });\n            });\n\n            it('should only query the API once', () => {\n                expect.assertions(4);\n\n                return configuration.get('systemId').then((res1) => {\n                    expect(res1).toBe(mockConfiguration.systemId);\n                    expect(mockApi.get.mock.calls[0][0]).toBe('configuration');\n\n                    configuration.get('systemId').then((res2) => {\n                        expect(res2).toBe(mockConfiguration.systemId);\n                        expect(mockApi.get.mock.calls[0][0]).toBe('configuration');\n                    });\n                });\n            });\n\n            it('should query the API twice if ignoreCache is true', () => {\n                expect.assertions(4);\n\n                return configuration.get('systemId', true).then((res1) => {\n                    expect(res1).toBe(mockConfiguration.systemId);\n                    expect(mockApi.get.mock.calls[0][0]).toBe('configuration');\n\n                    configuration.get('systemId', true).then((res2) => {\n                        expect(res2).toBe(mockConfiguration.systemId);\n                        expect(mockApi.get.mock.calls[1][0]).toBe('configuration');\n                    });\n                });\n            });\n\n            it('should throw an error when asked for an unknown config option', () => {\n                expect.assertions(1);\n\n                return configuration.get('someRandomOptionThatDoesntExist').catch((err) => {\n                    expect(err).toMatchSnapshot();\n                });\n            });\n        });\n\n        describe('.set()', () => {\n            it('should not be able to change the systemId', () => {\n                expect.assertions(1);\n\n                return configuration.set('systemId', 'my-random-system-id')\n                    .catch((err) => {\n                        expect(err).toMatchSnapshot();\n                    });\n            });\n\n            it('should not attempt to change unknown settings', () => {\n                expect.assertions(1);\n\n                return configuration.set('completelyCrazyConfigurationOption', 'totally rediculous value')\n                    .then(() => {\n                        // TODO: useless assertion\n                        expect(true).toBe(true);\n                    });\n            });\n\n            it('should call DELETE to remove feedback recipients', () => {\n                expect.assertions(3);\n\n                return configuration.set('feedbackRecipients', 'null')\n                    .then(() => {\n                        expect(mockApi.post).toHaveBeenCalledTimes(0);\n                        expect(mockApi.delete).toHaveBeenCalledTimes(1);\n                        expect(mockApi.delete.mock.calls[0][0]).toBe('configuration/feedbackRecipients');\n                    });\n            });\n\n            it('should call DELETE to remove self registration role', () => {\n                expect.assertions(2);\n\n                return configuration.set('selfRegistrationRole', null)\n                    .then(() => {\n                        expect(mockApi.post).toHaveBeenCalledTimes(0);\n                        expect(mockApi.delete.mock.calls[0][0]).toBe('configuration/selfRegistrationRole');\n                    });\n            });\n\n            it('should call DELETE to remove self registration organisation unit', () => {\n                expect.assertions(2);\n\n                return configuration.set('selfRegistrationOrgUnit', 'null')\n                    .then(() => {\n                        expect(mockApi.post).toHaveBeenCalledTimes(0);\n                        expect(mockApi.delete.mock.calls[0][0]).toBe('configuration/selfRegistrationOrgUnit');\n                    });\n            });\n\n            it('should convert CORS string to an array', () => configuration.set('corsWhitelist', mockCorsWhitelistText)\n                .then(() => {\n                    expect(mockApi.post.mock.calls[0][0]).toBe('configuration/corsWhitelist');\n                    expect(mockApi.post.mock.calls[0][1]).toEqual(mockConfiguration.corsWhitelist);\n                }));\n\n            it('should post new settings to the API', () => {\n                mockApi.post.mockClear();\n\n                return configuration.set('infrastructuralPeriodType', 'Monthly')\n                    .then(() => {\n                        expect(mockApi.post.mock.calls[0][0]).toBe('configuration/infrastructuralPeriodType');\n                        expect(mockApi.post.mock.calls[0][1]).toBe('Monthly');\n                    });\n            });\n\n            it('should reject a promise when no configuration can be found for the key', () => {\n                mockApi.post.mockReset();\n                mockApi.post.mockReturnValue(Promise.reject('StackTrace!'));\n\n                return configuration.set('thisKeyDoesNotExist', 'Some value')\n                    .catch(message => message)\n                    .then((message) => {\n                        expect(message).toBe('No configuration found for thisKeyDoesNotExist');\n                    });\n            });\n        });\n    });\n});\n"],"file":"SystemConfiguration_spec.js"}