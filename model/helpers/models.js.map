{"version":3,"sources":["../../../src/model/helpers/models.js"],"names":["hasPropertyOnModelValidation","property","model","Boolean","hasModelValidationForProperty","modelDefinition","modelValidations","pickHttpStatus","pickResponseUid","getModelValidationForProperty","propertyName","pickType","pickEmbeddedObject","pickOwner","pickTypeFromModelValidation","pickEmbeddedObjectFromModelValidation","pickOwnerFromModelValidation","updateModelFromResponseStatus","result","responseUid","dataValues","id","href","apiEndpoint","join","resetDirtyState"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AAEA,IAAMA,4BAA4B,GAAG,SAA/BA,4BAA+B,CAACC,QAAD,EAAWC,KAAX;AAAA,SACjCC,OAAO,CAAC,4DAAyCF,QAAzC,GAAqDC,KAArD,CAAD,CAD0B;AAAA,CAArC;;AAGO,SAASE,6BAAT,CAAuCF,KAAvC,EAA8CD,QAA9C,EAAwD;AAC3D,SAAOE,OAAO,CACVH,4BAA4B,CAACC,QAAD,EAAWC,KAAX,CAA5B,IACI,2BAAeA,KAAK,CAACG,eAAN,CAAsBC,gBAArC,EAAuDL,QAAvD,CAFM,CAAd;AAIH;;AAED,IAAMM,cAAc,GAAG,iBAAK,YAAL,CAAvB;AACA,IAAMC,eAAe,GAAG,iBAAK,cAAL,CAAxB;;AACA,IAAMC,6BAA6B,GAAG,SAAhCA,6BAAgC,CAAAC,YAAY;AAAA,SAC9C,4DAAyCA,YAAzC,EAD8C;AAAA,CAAlD;;AAEA,IAAMC,QAAQ,GAAG,iBAAK,MAAL,CAAjB;AACA,IAAMC,kBAAkB,GAAG,iBAAK,gBAAL,CAA3B;AACA,IAAMC,SAAS,GAAG,iBAAK,OAAL,CAAlB;;AAEO,IAAMC,2BAA2B,GAAG,SAA9BA,2BAA8B,CAACb,QAAD,EAAWC,KAAX;AAAA,SACvCS,QAAQ,CAACF,6BAA6B,CAACR,QAAD,CAA7B,CAAwCC,KAAxC,CAAD,CAD+B;AAAA,CAApC;;;;AAEA,IAAMa,qCAAqC,GAAG,SAAxCA,qCAAwC,CAACd,QAAD,EAAWC,KAAX;AAAA,SACjDU,kBAAkB,CAACH,6BAA6B,CAACR,QAAD,CAA7B,CAAwCC,KAAxC,CAAD,CAD+B;AAAA,CAA9C;;;;AAGA,IAAMc,4BAA4B,GAAG,SAA/BA,4BAA+B,CAACf,QAAD,EAAWC,KAAX;AAAA,SACxCW,SAAS,CAACJ,6BAA6B,CAACR,QAAD,CAA7B,CAAwCC,KAAxC,CAAD,CAD+B;AAAA,CAArC,C,CAGP;;;;;AACO,SAASe,6BAAT,CAAuCC,MAAvC,EAA+C;AAClD,MAAMC,WAAW,GAAGX,eAAe,CAACU,MAAD,CAAnC,CADkD,CAGlD;;AACA,MAAIX,cAAc,CAACW,MAAD,CAAd,KAA2B,SAA3B,IAAwC,qBAAWC,WAAX,CAA5C,EAAqE;AACjE,SAAKC,UAAL,CAAgBC,EAAhB,GAAqBF,WAArB;AACA,SAAKC,UAAL,CAAgBE,IAAhB,GAAuB,CACnB,KAAKjB,eAAL,CAAqBkB,WADF,EAEnB,KAAKH,UAAL,CAAgBC,EAFG,EAGrBG,IAHqB,CAGhB,GAHgB,CAAvB;AAIH,GAViD,CAYlD;;;AACA,OAAKC,eAAL;AAEA,SAAOP,MAAP;AACH","sourcesContent":["import { isValidUid } from '../../uid'\nimport { hasOwnProperty } from '../../lib/check'\nimport { pick } from '../../lib/utils'\n\nconst hasPropertyOnModelValidation = (property, model) =>\n    Boolean(pick(`modelDefinition.modelValidations.${property}`)(model))\n\nexport function hasModelValidationForProperty(model, property) {\n    return Boolean(\n        hasPropertyOnModelValidation(property, model) &&\n            hasOwnProperty(model.modelDefinition.modelValidations, property)\n    )\n}\n\nconst pickHttpStatus = pick('httpStatus')\nconst pickResponseUid = pick('response.uid')\nconst getModelValidationForProperty = propertyName =>\n    pick(`modelDefinition.modelValidations.${propertyName}`)\nconst pickType = pick('type')\nconst pickEmbeddedObject = pick('embeddedObject')\nconst pickOwner = pick('owner')\n\nexport const pickTypeFromModelValidation = (property, model) =>\n    pickType(getModelValidationForProperty(property)(model))\nexport const pickEmbeddedObjectFromModelValidation = (property, model) =>\n    pickEmbeddedObject(getModelValidationForProperty(property)(model))\n\nexport const pickOwnerFromModelValidation = (property, model) =>\n    pickOwner(getModelValidationForProperty(property)(model))\n\n// This function is called with `.call` with the Model as it's `this`\nexport function updateModelFromResponseStatus(result) {\n    const responseUid = pickResponseUid(result)\n\n    // Set the id and href of the newly created object if we got an id in the response\n    if (pickHttpStatus(result) === 'Created' && isValidUid(responseUid)) {\n        this.dataValues.id = responseUid\n        this.dataValues.href = [\n            this.modelDefinition.apiEndpoint,\n            this.dataValues.id,\n        ].join('/')\n    }\n\n    // Object is saved to the api, so it's now clean\n    this.resetDirtyState()\n\n    return result\n}\n"],"file":"models.js"}