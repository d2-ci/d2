{"version":3,"sources":["../../../src/i18n/__tests__/I18n.spec.js"],"names":["jest","mock","describe","mockApi","i18n","mockTranslations","general_settings","yes","no","system_settings_in_french","string_with_variable","mockUnicode","mockEscape","mockPropsFile","beforeEach","MockApi","getApi","I18n","afterEach","mockReset","it","expect","toThrowErrorMatchingSnapshot","api","toBe","addSource","toBeInstanceOf","Function","addStrings","load","sources","fn","done","getTranslation","e","getI18n","strings","Array","from","toContain","length","spyOn","add","toHaveBeenCalledTimes","apiGet","apiPost","apiReq","get","mockReturnValueOnce","Promise","resolve","post","request","then","err","toEqual","reject","setTimeout","string_that_has_no_translation","translations","toBeUndefined","mockReturnValue","Object","keys","forEach","key","not","sub1","variable","sub2","catch","isTranslated","toThrowError","Error","getUntranslatedStrings","undefined","str"],"mappings":"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","sourcesContent":["import MockApi from '../../api/Api';\nimport I18n from '../../i18n/I18n';\n\njest.mock('../../api/Api');\n\ndescribe('Internationalisation (I18n)', () => {\n    let mockApi;\n    let i18n;\n\n    const mockTranslations = {\n        general_settings: 'General settings',\n        yes: 'Yup',\n        no: 'Nope',\n        system_settings_in_french: 'Paramètres du système',\n        // 'escapes': 'Characters may be escaped! Even\\nnewlines?!?',\n        string_with_variable: 'Some times $$variable$$ are useful',\n    };\n\n    const mockUnicode = 'Param\\\\u00e8tres du syst\\\\u00e8me';\n    const mockEscape = 'Characters\\\\ may \\\\b\\\\e \\\\e\\\\s\\\\c\\\\a\\\\p\\\\e\\\\d\\\\!\\\\\\\\ Even\\\\\\nnewline\\\\s\\\\?\\\\!\\\\?';\n    const mockPropsFile = `${'general_settings=General settings\\n' +\n        'yes=Yup\\n' +\n        'no=Nope\\n\\n# Blank lines and commends - ignored?\\n#\\n\\n' +\n        'system_settings_in_french='}${mockUnicode}\\n` +\n        `escapes=${mockEscape}\\n`;\n\n    beforeEach(() => {\n        mockApi = MockApi.getApi();\n        i18n = new I18n();\n    });\n\n    afterEach(() => {\n        MockApi.mockReset();\n    });\n\n    it('should not be allowed to be called without new', () => {\n        expect(() => I18n()).toThrowErrorMatchingSnapshot(); // eslint-disable-line\n    });\n\n    it('should set an instance of Api onto the SystemConfiguration instance', () => {\n        expect(i18n.api).toBe(mockApi);\n    });\n\n    it('addSource() should be a function', () => {\n        expect(i18n.addSource).toBeInstanceOf(Function);\n    });\n\n    it('addStrings() should be a function', () => {\n        expect(i18n.addStrings).toBeInstanceOf(Function);\n    });\n\n    it('load() should be a function', () => {\n        expect(i18n.load).toBeInstanceOf(Function);\n    });\n\n    it('should set the passed sources onto the object', () => {\n        const sources = ['translation_18n'];\n\n        i18n = new I18n(sources);\n\n        expect(i18n.sources).toBe(sources);\n    });\n\n    it('should use the passed Api object', () => {\n        mockApi = jest.fn();\n\n        i18n = new I18n([], mockApi);\n\n        expect(i18n.api).toBe(mockApi);\n    });\n\n    it('getTranslations() should throw an error is translations haven\\'t been loaded yet', (done) => {\n        try {\n            i18n.getTranslation('some_string');\n            done('No error thrown!');\n        } catch (e) {\n            done();\n        }\n    });\n\n    describe('getI18n', () => {\n        it('should be a function on the I18n class', () => {\n            expect(typeof I18n.getI18n).toBe('function');\n        });\n\n        it('should return a new instanceof I18n', () => {\n            expect(I18n.getI18n()).toBeInstanceOf(I18n);\n        });\n    });\n\n    describe('addStrings()', () => {\n        it('accepts a single string', () => {\n            i18n.addStrings('yes');\n            const strings = Array.from(i18n.strings);\n            expect(strings).toContain('yes');\n            expect(strings.length).toBe(1);\n        });\n\n        it('accepts an array of strings', () => {\n            i18n.addStrings(['yes', 'no', 'maybe']);\n            const strings = Array.from(i18n.strings);\n            expect(strings).toContain('yes');\n            expect(strings).toContain('no');\n            expect(strings).toContain('maybe');\n            expect(strings.length).toBe(3);\n        });\n\n        it('handles consequtive calls', () => {\n            i18n.addStrings(['yes', 'no']);\n            i18n.addStrings('maybe');\n            i18n.addStrings('probably');\n            const strings = Array.from(i18n.strings);\n            expect(strings).toContain('yes');\n            expect(strings).toContain('no');\n            expect(strings).toContain('maybe');\n            expect(strings).toContain('probably');\n            expect(strings.length).toBe(4);\n        });\n\n        it('doesn\\'t add duplicates', () => {\n            i18n.addStrings(['yes', 'no']);\n            i18n.addStrings(['no', 'maybe']);\n            i18n.addStrings(['maybe', 'probably', 'yes']);\n            const strings = Array.from(i18n.strings);\n            expect(strings).toContain('yes');\n            expect(strings).toContain('no');\n            expect(strings).toContain('maybe');\n            expect(strings).toContain('probably');\n            expect(strings.length).toBe(4);\n        });\n\n        it('should not add empty strings', () => {\n            jest.spyOn(i18n.strings, 'add');\n\n            i18n.addStrings(['yes', '', '  ']);\n\n            expect(i18n.strings.add).toHaveBeenCalledTimes(1);\n        });\n    });\n\n    describe('load()', () => {\n        let apiGet;\n        let apiPost;\n        let apiReq;\n\n        beforeEach(() => {\n            apiGet = mockApi.get.mockReturnValueOnce(Promise.resolve(mockTranslations));\n\n            apiPost = mockApi.post.mockReturnValueOnce(Promise.resolve(mockTranslations));\n\n            apiReq = mockApi.request.mockReturnValueOnce(Promise.resolve(mockPropsFile));\n\n            i18n.addStrings(['yes', 'no']);\n        });\n\n        it('should return a promise', (done) => {\n            i18n.load().then(() => {\n                done();\n            }, (err) => {\n                done(err);\n            });\n        });\n\n        it('should POST to get untranslated strings', (done) => {\n            i18n.load().then(() => {\n                try {\n                    expect(apiGet).toHaveBeenCalledTimes(0);\n                    expect(apiPost).toHaveBeenCalledTimes(1);\n                    expect(apiReq).toHaveBeenCalledTimes(0);\n                    expect(i18n.getTranslation('yes')).toEqual(mockTranslations.yes);\n                    done();\n                } catch (e) {\n                    done(e);\n                }\n            }, (err) => {\n                done(err);\n            });\n        });\n\n        it('should load props files first', () => {\n            i18n.addSource('props_file_name');\n\n            return i18n.load().then(() => {\n                expect(apiGet).toHaveBeenCalledTimes(0);\n                expect(apiPost).toHaveBeenCalledTimes(0);\n                expect(apiReq).toHaveBeenCalledTimes(1);\n            });\n        });\n\n        it('keeps going if one props file fails', (done) => {\n            i18n.addSource('props_file_one');\n            i18n.addSource('props_file_two');\n            i18n.addSource('props_file_three');\n\n            apiReq.mockReset();\n            apiReq\n                .mockReturnValueOnce(Promise.resolve(mockPropsFile))\n                .mockReturnValueOnce(Promise.reject('404 Fail or something'))\n                .mockReturnValueOnce(Promise.resolve(''));\n\n            i18n.load().then(() => {\n                try {\n                    expect(apiGet).toHaveBeenCalledTimes(0);\n                    expect(apiPost).toHaveBeenCalledTimes(0);\n                    expect(apiReq).toHaveBeenCalledTimes(3);\n                    done();\n                } catch (e) {\n                    done(e);\n                }\n            }, (err) => {\n                done(err);\n            });\n        });\n\n        it('chooses strings based on source order', () => {\n            i18n.addSource('slow_props_file');\n            i18n.addSource('fast_props_file');\n\n            apiReq.mockReset();\n            apiReq\n                .mockReturnValueOnce(new Promise((resolve) => {\n                    setTimeout(() => {\n                        resolve('result=first priority file\\n');\n                    });\n                }))\n                .mockReturnValueOnce(Promise.resolve('result=first file to load\\n'));\n\n            return i18n.load().then(() => {\n                expect(i18n.getTranslation('result')).toEqual('first priority file');\n            });\n        });\n\n        it('should not add the strings if no responses were returned', () => {\n            i18n.addStrings(['string_that_has_no_translation']);\n            mockApi.post.mockReturnValueOnce(Promise.resolve({\n                string_that_has_no_translation: 'string_that_has_no_translation',\n            }));\n\n            return i18n.load()\n                .then(() => expect(i18n.translations.string_that_has_no_translation).toBeUndefined());\n        });\n    });\n\n    describe('async API', () => {\n        beforeEach(() => {\n            i18n.api.get\n                .mockReturnValue(Promise.resolve(mockTranslations));\n\n            i18n.api.request\n                .mockReturnValue(Promise.resolve(mockPropsFile));\n\n            i18n.api.post\n                .mockReturnValue(Promise.resolve(mockTranslations));\n\n            i18n.addSource('mockPropsFile');\n            i18n.addStrings(Object.keys(mockTranslations));\n        });\n\n        describe('getTranslation()', () => {\n            it('returns the correct translations', (done) => {\n                i18n.load().then(() => {\n                    try {\n                        Object.keys(mockTranslations).forEach((key) => {\n                            expect(i18n.getTranslation(key)).toEqual(mockTranslations[key]);\n                        });\n                        done();\n                    } catch (e) {\n                        done(e);\n                    }\n                });\n            });\n\n            it('decodes unicode entities from properties files', () => i18n.load().then(() => {\n                expect(mockApi.get).toHaveBeenCalledTimes(0);\n                expect(mockApi.post).toHaveBeenCalledTimes(1);\n                expect(mockApi.request).toHaveBeenCalledTimes(1);\n                expect(i18n.getTranslation('system_settings_in_french'))\n                    .toEqual(mockTranslations.system_settings_in_french);\n                expect(i18n.getTranslation('system_settings_in_french')).not.toEqual(mockUnicode);\n            }));\n\n            it('returns ** string ** for unknown strings', (done) => {\n                i18n.load().then(() => {\n                    try {\n                        expect(i18n.getTranslation('string')).toEqual('** string **');\n                        done();\n                    } catch (e) {\n                        done(e);\n                    }\n                });\n            });\n\n            it('replaces $$variable$$ in translations', (done) => {\n                i18n.load().then(() => {\n                    const sub1 = i18n.getTranslation('string_with_variable', { variable: 'tests' });\n                    const sub2 = i18n.getTranslation('string_with_variable', { variable: 'FUNNY TRANSLATIONS' });\n\n                    expect(sub1).toBe('Some times tests are useful');\n                    expect(sub2).toBe('Some times FUNNY TRANSLATIONS are useful');\n                    done();\n                }).catch(done);\n            });\n        });\n\n        describe('isTranslated()', () => {\n            it('returns true for translated strings', (done) => {\n                i18n.load().then(() => {\n                    try {\n                        Object.keys(mockTranslations).forEach((key) => {\n                            expect(i18n.isTranslated(key)).toEqual(true);\n                        });\n                        done();\n                    } catch (e) {\n                        done(e);\n                    }\n                });\n            });\n\n            it('returns false for untranslated strings', (done) => {\n                i18n.load().then(() => {\n                    try {\n                        expect(i18n.isTranslated('string')).toEqual(false);\n                        done();\n                    } catch (e) {\n                        done(e);\n                    }\n                });\n            });\n\n            it('totally tilts out if translations haven\\'t been loaded yet', (done) => {\n                try {\n                    expect(i18n.isTranslated('some random string')).toThrowError(Error);\n                    done(new Error('No error thrown'));\n                } catch (e) {\n                    done();\n                }\n            });\n        });\n\n        describe('getUntranslatedStrings()', () => {\n            it('returns undefined if translations haven\\'t been loaded yet', () => {\n                expect(i18n.getUntranslatedStrings()).toEqual(undefined);\n            });\n\n            it('returns an array', (done) => {\n                i18n.load().then(() => {\n                    try {\n                        expect(i18n.getUntranslatedStrings()).toBeInstanceOf(Array);\n                        done();\n                    } catch (e) {\n                        done(e);\n                    }\n                });\n            });\n\n            it('doesn\\'t return translated strings', () => {\n                i18n.addStrings('string');\n\n                return i18n.load().then(() => {\n                    const str = i18n.getUntranslatedStrings();\n                    expect(str).toContain('string');\n                    expect(str).not.toContain('yes');\n                    expect(str).not.toContain('some_random_string');\n                });\n            });\n        });\n    });\n});\n"],"file":"I18n.spec.js"}